#!/bin/sh

filename=$1
title=`basename ${1}`
graphName=../graphs/${title}.ps
trans=transposed
cat ${filename} | grep "GRAPH: " | sed 's/GRAPH: '// | ./transpose.awk > ${trans}

mkdir -p ../graphs

cat base-gnuplot-script > plotscript
echo "set title \"${title}\"" >> plotscript
echo "set output \"${graphName}\"" >> plotscript
echo "set xlabel \"Invocations\"" >> plotscript
echo "set ylabel \"Execution time (s)\"" >> plotscript
echo "plot \"${trans}\" using 1, '' using 2, '' using 3, '' using 4, '' using 5" >> plotscript
gnuplot plotscript
rm plotscript
rm ${trans}
